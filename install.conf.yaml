- defaults:
    link:
      relink: true
    clean:
      force: true

- clean:
    ~/:
    ~/Library/Application Support/Code/User/:
      recursive: true
    ~/.config:
      recursive: true

- create:
    - ~/projects/github.com
    - ~/projects/gitlab.com
    - ~/.vim/undo-history
    - ~/.nvm
    - ~/.gem/ruby/
    - ~/.config
    - ~/.config/pip
    - ~/.config/direnv
    - ~/.config/kitty
    - ~/.config/lsd
    - ~/.config/iterm2
    - ~/.config/gitui
    - ~/.config/bat
    - ~/.config/ghostty
    - ~/.config/mise
    - ~/.config/atuin
    - ~/.config/procs
    - ~/.kube
    - ~/.kube/configs
    - ~/.local/bin/
    - /usr/local/lib/jvm
    - /usr/local/lib/gnubin

- link:
    ~/:
      glob: true
      path: etc/.*

    ~/.local/bin/:
      glob: true
      path: bin/*

    ~/.local/bin/dotbot: dotbot/bin/dotbot

    ~/.zshrc: shell/zsh/.zshrc
    ~/.zshenv: shell/zsh/.zshenv
    ~/.p10k.zsh: shell/zsh/themes/p10k.zsh
    ~/.zimrc: shell/zsh/.zim/.zimrc

    ~/.gitignore: git/.gitignore
    ~/.gitconfig.local: git/.gitconfig.local

    ~/.Brewfile: os/mac/brew/Brewfile

    ~/.vimrc: editors/vim/.vimrc

    # ~/.config/direnv/lib: tools/direnv/lib
    ~/.config/direnv/config.toml: tools/direnv/config.toml
    ~/.config/pip/pip.conf: langs/python/pip.conf
    ~/.config/ghostty/config: tools/ghostty/config
    ~/.config/lsd/config.yaml: tools/lsd/config.yaml
    ~/.config/bat/config: tools/bat/config
    ~/.config/gitui/theme.ron: tools/gitui/theme.ron
    ~/.config/btop: tools/btop
    ~/.config/k9s: tools/k9s
    ~/.config/mise/config.toml: tools/mise/config.toml
    ~/.config/mise/mise.lock: tools/mise/mise.lock
    ~/.config/atuin/config.toml: tools/atuin/config.toml
    ~/.config/procs/config.toml: tools/procs/config.toml
    ~/.gitkraken/config: tools/gitkraken/config
    ~/.gitkraken/themes/mocha.jsonc: tools/gitkraken/themes/mocha.jsonc

    ~/Library/Application Support/Code/User/:
      create: true
      glob: true
      path: editors/vscode/*.json
      relink: true
      force: true
      if: "[ `uname` = Darwin ]"
    ~/Library/Application Support/Code/User/snippets:
      create: true
      path: editors/vscode/snippets
      relink: true
      force: true
      if: "[ `uname` = Darwin ]"

    ~/.config/Code/User/:
      create: true
      glob: true
      path: editors/vscode/*.json
      relink: true
      if: "[ `uname` != Darwin ]"
    ~/.config/Code/User/snippets:
      create: true
      path: editors/vscode/snippets
      relink: true
      if: "[ `uname` != Darwin ]"

- shell:
    - command: git submodule update --init --recursive
      description: Installing submodules
    - command: chmod +x ./scripts/*
      description: Making ./scripts executable
    - command: chmod +x ./bin/*
      description: Making ./bin executable
    - command: ./scripts/install
      description: Running installers
      stdin: true
      stdout: true
      stderr: true
    - command: ./scripts/configure
      description: Running configurators
      stdin: true
      stdout: true
      stderr: true
    - command: git config --global dotfiles.lastupdate "$(date +%Y-%m-%d-%H:%M)"
      description: Register last update
      stdin: true
      stdout: true
      stderr: true
